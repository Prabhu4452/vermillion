{
    "networks": {
        "iudx-net": {
            "driver": "overlay"
            }
    },
    "services": {
        "authenticator": {
            "deploy": {
                "labels": {
                    "type": "authenticator"
                },
                "placement": {
                    "constraints": [
                        "node.role==worker"
                    ]
                },
                "replicas": 1
            },
            "env_file": [
                ".env"
            ],
            "environment": [
                "WAIT_HOSTS=postgres:5432"
            ],
            "hostname": "authenticator",
            "image": "iudx/authenticator",
            "networks": [
                "iudx-net"
            ],
            "restart": "always",
            "volumes": [
                "../iudx-authenticator:/iudx-authenticator/"
            ]
        },
        "postgres": {
            "deploy": {
                "labels": {
                    "type": "auth-db"
                },
                "placement": {
                    "constraints": [
                        "node.role == manager"
                    ]
                }
            },
            "env_file": [
                ".env"
            ],
            "hostname": "postgres",
            "image": "iudx/postgres",
            "networks": [
                "iudx-net"
            ],
            "ports": [
                "5432:5432"
            ]
        },
        "vertx": {
            "deploy": {
                "labels": {
                    "type": "http-proxy"
                },
                "placement": {
                    "constraints": [
                        "node.role==manager"
                    ]
                },
                "replicas": 1
            },
            "env_file": [
                ".env"
            ],
            "environment": [
                "WAIT_HOSTS_TIMEOUT=120",
                "WAIT_HOSTS=postgres:5432,rabbit:5672,authenticator:80"
            ],
            "hostname": "vertx",
            "image": "iudx/vertx",
            "networks": [
                "iudx-net"
            ],
            "ports": [
                "443:8443"
            ],
            "volumes": [
                "../iudx-api-server:/iudx-api-server/"
            ]
        }
    },
    "version": "3"
}
