{
    "networks": {
        "iudx-net": {
            "driver": "overlay"
        }
    },
    "services": {
        "postgres": {
            "deploy": {
                "labels": {
                    "type": "auth-db"
                },
                "placement": {
                    "constraints": [
                        "node.role == manager"
                    ]
                }
            },
            "env_file": [
                ".env"
            ],
            "hostname": "postgres",
            "image": "iudx/postgres",
            "networks": [
                "iudx-net"
            ]
        },
        "rabbit1": {
            "deploy": {
                "labels": {
                    "type": "broker"
                },
                "placement": {
                    "constraints": [
                        "node.role == worker"
                    ]
                }
            },
            "env_file": [
                ".env"
            ],
            "hostname": "rabbit1",
            "image": "iudx/rabbitmq",
            "networks": [
                "iudx-net"
            ],
            "ports": [
                "15673:15672",
                "5673:5672"
            ],
            "volumes": [
                "../authenticator:/authenticator/",
                "../conf/rabbitmq:/etc/rabbitmq/"
            ]
        },
        "rabbit2": {
            "deploy": {
                "labels": {
                    "type": "broker"
                },
                "placement": {
                    "constraints": [
                        "node.role == worker"
                    ]
                }
            },
            "env_file": [
                ".env"
            ],
            "hostname": "rabbit2",
            "image": "iudx/rabbitmq",
            "networks": [
                "iudx-net"
            ],
            "ports": [
                "15674:15672",
                "5674:5672"
            ],
            "volumes": [
                "../authenticator:/authenticator/",
                "../conf/rabbitmq:/etc/rabbitmq/"
            ]
        },
        "vertx": {
            "deploy": {
                "labels": {
                    "type": "http-proxy"
                },
                "replicas": 1
            },
            "env_file": [
                ".env"
            ],
            "hostname": "vertx",
            "image": "iudx/vertx",
            "networks": [
                "iudx-net"
            ],
            "ports": [
                "443:8443"
            ],
            "volumes": [
                "../iudx-api-server:/iudx-api-server/"
            ]
        }
    },
    "version": "3"
}
